# Урок 5

## **SQL – оконные функции**

---

### **Основное ДЗ из презентации**

**Таблица cars.**

![Созданная таблица](cars.PNG "Машины")

**1.    Создайте представление, в которое попадут автомобили стоимостью  до 25 000 долларов.**

![Пример решения](./cost_less_25000.PNG "Машины до 25000")

---

**2.    Изменить в существующем представлении порог для стоимости: пусть цена будет до 30 000 долларов (используя оператор OR REPLACE).**

![Пример решения](./cost_increased_30000.PNG "Машины до 30000")

---

**3.    Создайте представление, в котором будут только автомобили марки “Skoda” и “Audi”.**

![Пример решения](./select_brands.PNG "Марки “Skoda” и “Audi”")

---

**Таблица train_shedule.**

![Созданная таблица](./station_time.PNG "Время прибытия на станцию")

---

**Добавьте новый столбец под названием «время до следующей станции».**
**Чтобы получить это значение, мы вычитаем время станций для пар смежных станций.**

- **Мы можем вычислить это значение  без использования оконной функции SQL, но это может быть очень сложно. Проще это сделать с помощью оконной функции LEAD. Эта функция сравнивает значения из одной строки со следующей строкой, чтобы получить результат. В этом случае функция сравнивает значения в столбце «время» для станции со станцией сразу после нее.**

![Пример решения](./time_between_stations.PNG "Обновленное расписание поездов")

---

### **Дополнительное задание**

**Для скрипта, поставленного в прошлом уроке (vk_db только с расширенными данными).**

- **Получите друзей пользователя с id=1 (решение задачи с помощью представления “друзья”).**

